---
layout: post
title: "Thoughts on the Dihedral Hidden Subgroup Problem (part 2)"
tags: maths cs
---

{% raw %}

  
<p>In a <a href="/thoughts-on-the-dihedral-hidden-subgroup-problem.html">previous post</a>, I've proposed a way to solve the Dihedral Hidden Subgroup Problem using a superposition of oracle evaluations. However, it seems to require a way to inverse the functions <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mi>x</mi> <mo>↦</mo> <mrow> <mi>f</mi> <mrow> <mo>(</mo> <mrow> <mi>x</mi> <mo>,</mo> <mo>.</mo> </mrow> <mo>)</mo> </mrow> </mrow> </mrow> </math> which is a bit cheating since we do not have this feature for the classical problem. In this post, we will consider the case <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>M</mi> <mo>=</mo> <mfrac> <mi>N</mi> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </mfrac> <mo>=</mo> <mn>2</mn> </math>, <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>d</mi> <mo>=</mo> <mn>2</mn> <mrow> <mi>d</mi> <mo>'</mo> </mrow> <mo>+</mo> <mi>b</mi> </math> and try to determine the parity <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> </math> of <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>d</mi> </math>. If <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>N</mi> </math> is a power of two, this is enough to find <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>d</mi> </math> recursively. As in the previous post, the main idea is to consider the superpositions</p>

<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ψ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> <mo>=</mo> <mrow> <mfrac> <mn>1</mn> <msqrt> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </msqrt> </mfrac> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <mi>i</mi> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <mo stretchy="false">∣</mo> <mrow> <mi>f</mi> <mo stretchy="false">(</mo> <mrow> <mn>2</mn> <mi>i</mi> </mrow> <mo>,</mo> <mn>0</mn> <mo stretchy="false">)</mo> </mrow> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math></p>

<p>and</p>

<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ϕ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> <mo>=</mo> <mrow> <mfrac> <mn>1</mn> <msqrt> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </msqrt> </mfrac> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <mi>i</mi> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <mo stretchy="false">∣</mo> <mrow> <mi>f</mi> <mo stretchy="false">(</mo> <mrow> <mn>2</mn> <mi>i</mi> </mrow> <mo>,</mo> <mn>1</mn> <mo stretchy="false">)</mo> </mrow> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math></p>

<p>Using the equality <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>f</mi> <mrow> <mo>(</mo> <mi>g</mi> <mrow> <mo>(</mo> <mrow> <mi>d</mi> <mo>,</mo> <mn>1</mn> </mrow> <mo>)</mo> </mrow> <mo>)</mo> </mrow> <mo>=</mo> <mi>f</mi> <mrow> <mo>(</mo> <mi>g</mi> <mo>)</mo> </mrow> </math> we can rewrite the latter state</p>

<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ϕ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> <mo>=</mo> <mrow> <mfrac> <mn>1</mn> <msqrt> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </msqrt> </mfrac> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <mi>i</mi> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <mo stretchy="false">∣</mo> <mrow> <mi>f</mi> <mo stretchy="false">(</mo> <mrow> <mrow> <mn>2</mn> <mi>i</mi> </mrow> <mo>−</mo> <mi>b</mi> </mrow> <mo>,</mo> <mn>0</mn> <mo stretchy="false">)</mo> </mrow> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math></p>

<p>If <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> <mo>=</mo> <mn>0</mn> </math>, the latter state is the same superposition as the former state, over <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </math> values of <math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </math>. Otherwise, <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> <mo>=</mo> <mn>1</mn> </math> and the latter state is the superposition over the <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </math> other values of <math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </math>. We let <math xmlns="http://www.w3.org/1998/Math/MathML"> <msubsup> <mi>f</mi> <mi>i</mi> <mi>b</mi> </msubsup> <mo>=</mo> <mrow> <mi>f</mi> <mo stretchy="false">(</mo> <mrow> <mrow> <mn>2</mn> <mi>i</mi> </mrow> <mo>−</mo> <mi>b</mi> </mrow> <mo>,</mo> <mn>0</mn> <mo stretchy="false">)</mo> </mrow> </math> and measure the product state <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ψ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ϕ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> </math> in the basis <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>+</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math>, <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>−</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math> . It turns out that this allows to distinguish the two cases:</p>

<ul>
	<li>If <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> <mo>=</mo> <mn>0</mn> </math>, the product contains vectors with the same coordinates <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <mi>i</mi> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <mi>i</mi> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math> for <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mi>i</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </math>. For the other vectors, we have a symmetry between the two coordinates. Hence we can group them by pairs <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>1</mn> </msub> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>2</mn> </msub> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mo>+</mo> <mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>2</mn> </msub> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>1</mn> </msub> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math> for <math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>i</mi> <mn>1</mn> </msub> <mo>&lt;</mo> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </math>. Finally, the product state belongs to the space spanned by <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math> and <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>+</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math>.</li>
	<li>If <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> <mo>=</mo> <mn>1</mn> </math>, the product contains vectors <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>1</mn> </msub> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>2</mn> </msub> <mn>1</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math> where the two coordinates are not equal. We never have two symmetric vectors i.e. which are the same after permutating the two coordinates. Moreover, each vector <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>1</mn> </msub> <mn>0</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>2</mn> </msub> <mn>1</mn> </msubsup> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math> is the expression of a sum/difference (according to the respective order of <math xmlns="http://www.w3.org/1998/Math/MathML"> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>1</mn> </msub> <mn>0</mn> </msubsup> </math> and <math xmlns="http://www.w3.org/1998/Math/MathML"> <msubsup> <mi>f</mi> <msub> <mi>i</mi> <mn>2</mn> </msub> <mn>1</mn> </msubsup> </math>) of two vectors <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>+</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math> and <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>−</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> </math>. So the product state belongs half to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>+</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math> and half to <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>−</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math>.</li>
</ul>

<p>Suppose that we have a procedure to create many states <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ψ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> </math> and <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ϕ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> </math>. We measure a state in the space <math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>−</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math> with probability <math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mi>b</mi> <mn>2</mn> </mfrac> </math>. So repeating the procedure a constant number of times allow to determine <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> </math> with high probability.</p>

<p>The only gap in the previous algorithm is whether we can create the states <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ψ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> </math> and <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ϕ</mi> <mn>0</mn> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> </math>. As in the <a href="/thoughts-on-the-dihedral-hidden-subgroup-problem.html">previous post</a>, this is possible if the gates <math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>V</mi> <mrow> <mi>f</mi> <mo>,</mo> <mo>.</mo> </mrow> </msub> </math> are available. Otherwise, we can create a superposition of states over <math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>ℤ</mi> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </msub> </math> and use the gate <math xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>U</mi> <mi>f</mi> </msub> </math> as well as a Quantum Fourier Transform to randomize the first coordinate. We get two random numbers <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <msub> <mi>j</mi> <mn>1</mn> </msub> <mo>,</mo> <msub> <mi>j</mi> <mn>2</mn> </msub> <mo>∈</mo> <msub> <mi>ℤ</mi> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </msub> </mrow> </math> and the states</p>

<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ψ</mi> <mrow> <msub> <mi>j</mi> <mn>1</mn> </msub> </mrow> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> <mo>=</mo> <mrow> <mfrac> <mn>1</mn> <msqrt> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </msqrt> </mfrac> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <mi>i</mi> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <msup> <mi>ⅇ</mi> <mfrac> <mrow> <mn>2</mn> <mi>ⅈ</mi> <mi>π</mi> <msub> <mi>j</mi> <mn>1</mn> </msub> <mi>i</mi> </mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </mfrac> </msup> <mrow> <mo stretchy="false">∣</mo> <mrow> <mi>f</mi> <mo stretchy="false">(</mo> <mrow> <mn>2</mn> <mi>i</mi> </mrow> <mo>,</mo> <mn>0</mn> <mo stretchy="false">)</mo> </mrow> <mo stretchy="false">⟩</mo> </mrow> </mrow> </mrow> </math></p>

<p>and<math display="block" xmlns="http://www.w3.org/1998/Math/MathML"> <mrow> <mo stretchy="false">∣</mo> <mrow> <msub> <mi>ϕ</mi> <mrow> <msub> <mi>j</mi> <mn>2</mn> </msub> </mrow> </msub> </mrow> <mo stretchy="false">⟩</mo> </mrow> <mo>=</mo> <mrow> <mfrac> <mrow> <msup> <mi>ⅇ</mi> <mfrac> <mrow> <mn>2</mn> <mi>ⅈ</mi> <mi>π</mi> <msub> <mi>j</mi> <mn>2</mn> </msub> <mrow> <mi>d</mi> <mo>′</mo> </mrow> </mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </mfrac> </msup> </mrow> <msqrt> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </msqrt> </mfrac> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <mi>i</mi> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <msup> <mi>ⅇ</mi> <mfrac> <mrow> <mn>2</mn> <mi>ⅈ</mi> <mi>π</mi> <msub> <mi>j</mi> <mn>2</mn> </msub> <mi>i</mi> </mrow> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </mfrac> </msup> <mrow> <mo stretchy="false">∣</mo> <mrow> <mi>f</mi> <mo stretchy="false">(</mo> <mrow> <mn>2</mn> <mi>i</mi><mo>−</mo><mi>b</mi> </mrow> <mo>,</mo> <mn>0</mn> <mo stretchy="false">)</mo> </mrow> <mo stretchy="false">⟩</mo> </mrow> </mrow> </mrow> </math></p>

<p>Next, we can apply the same measurement as above. After a bit of calculation,we get the probabilities:</p>

<table border="1" style="width: 100%">
	<colgroup>
		<col />
		<col />
		<col />
	</colgroup>
	<tbody>
		<tr>
			<th>Space</th>
			<th>case <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> <mo>=</mo> <mn>0</mn> </math></th>
			<th>case <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>b</mi> <mo>=</mo> <mn>1</mn> </math></th>
		</tr>
		<tr>
			<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math></td>
			<td><math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mn>1</mn> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </mfrac> </math></td>
			<td>0</td>
		</tr>
		<tr>
			<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>+</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math></td>
			<td><math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mn>2</mn> <mrow> <msup> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mn>2</mn> </msup> </mrow> </mfrac> <mrow> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mi>N</mi> <mo>′</mo> <mo lspace="verythinmathspace" rspace="0em">−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <msub> <mi>i</mi> <mn>1</mn> </msub> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <msup> <mi>cos</mi> <mn>2</mn> </msup> <mrow> <mfrac> <mi>π</mi> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </mfrac> <mrow> <mo stretchy="false">(</mo> <msub> <mi>j</mi> <mn>2</mn> </msub> <mo>−</mo> <msub> <mi>j</mi> <mn>1</mn> </msub> <mo stretchy="false">)</mo> </mrow> <mrow> <mo stretchy="false">(</mo> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>−</mo> <msub> <mi>i</mi> <mn>1</mn> </msub> <mo stretchy="false">)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </math></td>
			<td><math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mn>1</mn> <mn>2</mn> </mfrac> </math></td>
		</tr>
		<tr>
			<td><math display="inline" xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mrow> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> <mo>−</mo> <mrow> <mo stretchy="false">∣</mo> <mi>x</mi> <mo stretchy="false">⟩</mo> </mrow> <mrow> <mo stretchy="false">∣</mo> <mi>y</mi> <mo stretchy="false">⟩</mo> </mrow> </mrow> <mrow> <mi>x</mi> <mi>&lt;</mi> <mi>y</mi> <mo>∈</mo> <msub> <mi>ℤ</mi> <mi>N</mi> </msub> </mrow> </msub> </math></td>
			<td><math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mn>2</mn> <mrow> <msup> <mrow> <mi>N</mi> <mo>′</mo> </mrow> <mn>2</mn> </msup> </mrow> </mfrac> <mrow> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <mi>N</mi> <mo>′</mo> <mo lspace="verythinmathspace" rspace="0em">−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <munderover> <mo lspace="thinmathspace" rspace="thinmathspace">∑</mo> <mrow> <msub> <mi>i</mi> <mn>1</mn> </msub> <mo>=</mo> <mn>0</mn> </mrow> <mrow> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>−</mo> <mn>1</mn> </mrow> </munderover> <mrow> <msup> <mi>sin</mi> <mn>2</mn> </msup> <mrow> <mfrac> <mi>π</mi> <mrow> <mi>N</mi> <mo>′</mo> </mrow> </mfrac> <mrow> <mo stretchy="false">(</mo> <msub> <mi>j</mi> <mn>2</mn> </msub> <mo>−</mo> <msub> <mi>j</mi> <mn>1</mn> </msub> <mo stretchy="false">)</mo> </mrow> <mrow> <mo stretchy="false">(</mo> <msub> <mi>i</mi> <mn>2</mn> </msub> <mo>−</mo> <msub> <mi>i</mi> <mn>1</mn> </msub> <mo stretchy="false">)</mo> </mrow> </mrow> </mrow> </mrow> </mrow> </math></td>
			<td><math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mn>1</mn> <mn>2</mn> </mfrac> </math></td>
		</tr>
	</tbody>
</table>

<p>If we repeat the procedure several times, we need to take the means over the choice of <math xmlns="http://www.w3.org/1998/Math/MathML"> <mrow xmlns="http://www.w3.org/1998/Math/MathML"> <msub> <mi>j</mi> <mn>1</mn> </msub> <mo>,</mo> <msub> <mi>j</mi> <mn>2</mn> </msub> <mo>∈</mo> <msub> <mi>ℤ</mi> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </msub> </mrow> </math>. Using some <a href="http://en.wikipedia.org/wiki/List_of_trigonometric_identities#Power-reduction_formulas">trigonometric identities</a>, it is possible to write the sums of the first column <math xmlns="http://www.w3.org/1998/Math/MathML"> <mfrac> <mn>1</mn> <mn>2</mn> </mfrac> <mo>+</mo> <mi>S</mi> <mo>+</mo> <mrow> <mi>o</mi> <mrow> <mo>(</mo> <mfrac> <mn>1</mn> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </mfrac> <mo>)</mo> </mrow> </mrow> </math> where <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>S</mi> </math> is a sum of cosinus. Unfortunately, evaluating <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>S</mi> </math> with a computer suggests that <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>S</mi> <mo>=</mo> <mrow> <mi>Θ</mi> <mrow> <mo>(</mo> <mfrac> <mn>1</mn> <mrow> <mi>N</mi> <mo>'</mo> </mrow> </mfrac> <mo>)</mo> </mrow> </mrow> </math> . Hence, we can not distinguish the two cases with only a polynomial (in <math xmlns="http://www.w3.org/1998/Math/MathML"> <mi>log</mi> <mi>N</mi> </math>) number of samplings.</p>

<p>It is still open whether we can find a variation to make such an algorithm efficient...</p>


{% endraw %}
